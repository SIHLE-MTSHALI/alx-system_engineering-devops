#!/bin/bash
# Add port forwarding rule to before.rules
sudo sed -i '/^*filter/i *nat\n:PREROUTING ACCEPT [0:0]\n:INPUT ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:POSTROUTING ACCEPT [0:0]\n\n# Port forwarding rule\n-A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80\n\nCOMMIT\n' /etc/ufw/before.rules

# Add port forwarding rule to before6.rules for IPv6
sudo sed -i '/^*filter/i *nat\n:PREROUTING ACCEPT [0:0]\n:INPUT ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:POSTROUTING ACCEPT [0:0]\n\n# Port forwarding rule\n-A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80\n\nCOMMIT\n' /etc/ufw/before6.rules

# Reload ufw to apply the changes
sudo ufw reload
